"use strict";window.SVG3DTagCloud=function(o,t){function e(){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=t,n=e,n=0<l.width.toString().indexOf("%")||0<l.height.toString().indexOf("%")?(i=Math.round(o.offsetWidth/100*parseInt(l.width)),Math.round(i/100*parseInt(l.height))):(i=parseInt(l.width),parseInt(l.height));t<=i&&(i=t),e<=n&&(n=e),v={x:i/2,y:n/2},b.x=l.speed/v.x,b.y=l.speed/v.y,(f=n<=i?n/100*parseInt(l.radius):i/100*parseInt(l.radius))<1&&(f=1),(h=f/2)<l.radiusMin&&(h=l.radiusMin,f=2*h),m.setAttribute("width",i),m.setAttribute("height",n),l.bgDraw&&(y.setAttribute("width",i),y.setAttribute("height",n)),function(t){for(var e=0,i=p.length;e<i;e++)!function(t,e){var i=t.vectorPosition.x-w.x,n=t.vectorPosition.y-w.y,o=t.vectorPosition.z-w.z,o=Math.sqrt(i*i+n*n+o*o);t.vectorPosition.x/=o,t.vectorPosition.y/=o,t.vectorPosition.z/=o,t.vectorPosition.x*=e,t.vectorPosition.y*=e,t.vectorPosition.z*=e}(p[e],t)}(h)}function i(){for(var t,e=1,i=l.entries.length+1;e<i;e++){var n=Math.acos((2*e-1)/i-1),o=Math.sqrt(i*Math.PI)*n,r=Math.cos(o)*Math.sin(n),s=Math.sin(o)*Math.sin(n),a=Math.cos(n),a=(t=e-1,o=l.entries[e-1],n=r,r=s,s=a,a=void 0,(a={}).element=document.createElementNS(S,"text"),a.element.setAttribute("x",0),a.element.setAttribute("y",0),a.element.setAttribute("fill",l.fontColor),a.element.setAttribute("font-family",l.fontFamily),a.element.setAttribute("font-size",l.fontSize),a.element.setAttribute("font-weight",l.fontWeight),a.element.setAttribute("font-style",l.fontStyle),a.element.setAttribute("font-stretch",l.fontStretch),a.element.setAttribute("text-anchor","middle"),a.element.textContent=l.fontToUpperCase?o.label.toUpperCase():o.label,a.link=document.createElementNS(S,"a"),a.link.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o.url),a.link.setAttribute("target",o.target),a.link.addEventListener("mouseover",c,!0),a.link.addEventListener("mouseout",u,!0),a.link.appendChild(a.element),a.index=t,a.mouseOver=!1,a.vectorPosition={x:n,y:r,z:s},a.vector2D={x:0,y:0},m.appendChild(a.link),a);p.push(a)}}function n(t){for(var e=function(t){for(var e=0,i=p.length;e<i;e++){var n=p[e];if(n.element.getAttribute("x")===t.getAttribute("x")&&n.element.getAttribute("y")===t.getAttribute("y"))return n}}(t),i=0,n=p.length;i<n;i++){var o=p[i];o.index===e.index?o.mouseOver=!0:o.mouseOver=!1}}function r(){requestAnimFrame(r),function(){var t=b.x*x.x-l.speed,e=l.speed-b.y*x.y,t=t*P,e=e*P;A.sx=Math.sin(t),A.cx=Math.cos(t),A.sy=Math.sin(e),A.cy=Math.cos(e);for(var i=0,n=p.length;i<n;i++){var o,r=p[i];g&&(o=r.vectorPosition.x,a=r.vectorPosition.y*A.sy+r.vectorPosition.z*A.cy,r.vectorPosition.x=o*A.cx+a*A.sx,r.vectorPosition.y=r.vectorPosition.y*A.cy+r.vectorPosition.z*-A.sy,r.vectorPosition.z=o*-A.sx+a*A.cx);var s,a=l.fov/(l.fov+r.vectorPosition.z);r.vector2D.x=r.vectorPosition.x*a+v.x,r.vector2D.y=r.vectorPosition.y*a+v.y,r.element.setAttribute("x",r.vector2D.x),r.element.setAttribute("y",r.vector2D.y),g?(s=(h-r.vectorPosition.z)/f)<l.opacityOut&&(s=l.opacityOut):(s=parseFloat(r.element.getAttribute("opacity")),s+=r.mouseOver?(l.opacityOver-s)/l.opacitySpeed:(l.opacityOut-s)/l.opacitySpeed),r.element.setAttribute("opacity",s)}p=p.sort(function(t,e){return e.vectorPosition.z-t.vectorPosition.z})}()}function c(t){g=!1,n(t.target)}function u(t){g=!0}function s(t){x=function(t,e){t=t.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}(m,t)}function a(t){e()}var l={entries:[],width:480,height:480,radius:"70%",radiusMin:75,bgDraw:!0,bgColor:"#000",opacityOver:1,opacityOut:.05,opacitySpeed:6,fov:800,speed:2,fontFamily:"Arial, sans-serif",fontSize:"15",fontColor:"#fff",fontWeight:"normal",fontStyle:"normal",fontStretch:"normal",fontToUpperCase:!1};if(void 0!==t)for(var d in t)t.hasOwnProperty(d)&&l.hasOwnProperty(d)&&(l[d]=t[d]);if(!l.entries.length)return!1;var h,f,v,m,y,p=[],g=!0,x={x:0,y:0},w={x:0,y:0,z:0},b={x:0,y:0},A={sx:0,cx:0,sy:0,cy:0},P=Math.PI/180,S="http://www.w3.org/2000/svg";window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},(m=document.createElementNS(S,"svg")).addEventListener("mousemove",s),o.appendChild(m),l.bgDraw&&((y=document.createElementNS(S,"rect")).setAttribute("x",0),y.setAttribute("y",0),y.setAttribute("fill",l.bgColor),m.appendChild(y)),i(),e(),r(),window.addEventListener("resize",a)},"undefined"!=typeof jQuery&&function(e){e.fn.svg3DTagCloud=function(t){return this.each(function(){e.data(this,"plugin_SVG3DTagCloud")||e.data(this,"plugin_SVG3DTagCloud",new SVG3DTagCloud(this,t))})}}(jQuery);